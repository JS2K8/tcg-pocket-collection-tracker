import{r as t,j as e,L as _,C as v,U as S}from"./index-KWC0Yp9z.js";import{T as B,a as I,b as y,c as N}from"./tabs-BeEmQvrY.js";import{u as L}from"./useWindowDimensionsHook-C3kS-GHX.js";import{c as $,u as z,g as V,b as Y,a as A}from"./index-r7DvfM9J.js";import{s as G,b as C,e as E,t as k}from"./CardsDB-9ENfkm57.js";import{F as T}from"./FancyCard-BUYVqYPB.js";import{A as m,S as h,a as p,b as w}from"./alert-DacZzYBT.js";function M({cards:s,cardElement:n}){const o=$(),d=t.useRef(null),{width:a}=L(),r=t.useMemo(()=>[o.accessor("image",{id:"imageUrl"}),o.accessor("card_id",{id:"card_id"}),o.accessor("name",{id:"name"}),o.accessor("set_details",{id:"set_details"})],[]),i=z({columns:r,data:s,enableGrouping:!0,getCoreRowModel:Y(),getGroupedRowModel:V(),initialState:{grouping:["set_details"]}}),f=t.useMemo(()=>i.getGroupedRowModel().rows,[i.getGroupedRowModel().rows]);let x=5;a>800&&a<1e3?x=4:a<=800&&(x=3);const R=t.useMemo(()=>f.map(l=>{const c={type:"header",row:l},j=l.subRows.map(u=>({type:"data",row:u})),g=[];for(let u=0;u<j.length;u+=x)g.push(j.slice(u,u+x));return{header:c,gridRows:g}}),[f,x]),b=t.useMemo(()=>R.flatMap(l=>[{type:"header",height:60,data:l.header},...l.gridRows.map(c=>({type:"gridRow",height:250,data:c}))]),[R]),F=A({getScrollElement:()=>d.current,count:b.length,estimateSize:l=>(b[l].type==="header"?60:250)+12,overscan:5});return e.jsx("div",{ref:d,className:"h-[calc(100vh-180px)] overflow-y-auto",style:{scrollbarWidth:"none"},children:e.jsx("div",{style:{height:`${F.getTotalSize()}px`},className:"relative w-full",children:F.getVirtualItems().map(l=>{const c=b[l.index];return e.jsx("div",{style:{height:`${l.size}px`,transform:`translateY(${l.start}px)`},className:"absolute top-0 left-0 w-full",children:c.type==="header"?e.jsx("h2",{className:"mx-auto mt-10 text-center w-full max-w-[900px] scroll-m-20 border-b-2 border-slate-600 pb-2 font-semibold text-3xl tracking-tight transition-colors first:mt-0",children:c.data.row.getValue("set_details")}):e.jsx("div",{className:"flex justify-center gap-x-3",children:c.data.map(({row:j})=>{const g=j.original;return n(g)})})},l.key)})})})}function D({card:s}){const n=t.useMemo(()=>(s.amount_owned||2)-2,[s.amount_owned]),o=t.useMemo(()=>n*G[s.rarity],[n,s.rarity]);return e.jsxs("div",{className:"group flex w-32 flex-col items-center rounded-lg",children:[e.jsx(_,{viewTransition:!0,to:`/card/${s.card_id}`,state:{card:s},children:e.jsx(T,{card:s,selected:!0})}),e.jsxs("p",{className:"max-w-[130px] overflow-hidden text-ellipsis whitespace-nowrap font-semibold text-[12px] pt-2",children:[s.card_id," - ",s.name]}),e.jsxs("div",{className:"flex items-center gap-x-1",children:[e.jsx("span",{className:"w-7 text-center border-none rounded",children:n}),e.jsx("span",{className:"w-7 text-center border-none rounded",children:o})]})]})}function O(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(p,{children:"You have no sellable cards!"}),e.jsx(w,{children:"If you believe you have sellable cards, go to the collections page and input your collected cards to see what you can sell."})]})})}function U(){const{ownedCards:s}=t.use(v),n=t.useMemo(()=>s.filter(a=>a.amount_owned>=3),[s]),o=t.useMemo(()=>C.filter(a=>n.findIndex(r=>r.card_id===a.card_id)>-1).map(a=>{var r;return{...a,amount_owned:(r=n.find(i=>i.card_id===a.card_id))==null?void 0:r.amount_owned}}),[n]),d=t.useMemo(()=>o.filter(a=>Object.keys(G).includes(a.rarity)),[o]);return d&&d.length>0?e.jsx(M,{cards:d,cardElement:a=>e.jsx(D,{card:a})}):e.jsx(O,{})}function H({card:s}){return e.jsxs("div",{className:"group flex w-32 flex-col items-center rounded-lg",children:[e.jsx(_,{viewTransition:!0,to:`/card/${s.card_id}`,state:{card:s},children:e.jsx(T,{card:s,selected:!0})}),e.jsxs("p",{className:"max-w-[130px] overflow-hidden text-ellipsis whitespace-nowrap font-semibold text-[12px] pt-2",children:[s.card_id," - ",s.name]}),e.jsx("div",{className:"flex items-center gap-x-1",children:e.jsx("span",{className:"w-7 text-center border-none rounded",children:(s.amount_owned||1)-1})})]})}function W(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(p,{children:"Go track your cards"}),e.jsx(w,{children:"By tracking your cards, you can see what cards you still need to get, what cards you can trade with friends, and how many trade tokens you can earn with your current collection."})]})})}function P(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(p,{children:"You have no tradeable cards!"}),e.jsx(w,{children:"Go to the collections page and input your collected cards to see what you can trade."})]})})}function q(){const{ownedCards:s}=t.use(v);if(!s||s.every(r=>r.amount_owned<2))return e.jsx(W,{});const n=t.useMemo(()=>E.filter(r=>r.tradeable).map(r=>r.id),[]),o=t.useMemo(()=>s.filter(r=>r.amount_owned>1),[s]),d=t.useMemo(()=>C.filter(r=>o.findIndex(i=>i.card_id===r.card_id)>-1).map(r=>{var i;return{...r,amount_owned:(i=o.find(f=>f.card_id===r.card_id))==null?void 0:i.amount_owned}}),[o]),a=t.useMemo(()=>d.filter(r=>Object.keys(k).includes(r.rarity)&&n.includes(r.expansion)),[d]);return a&&a.length>0?e.jsx(M,{cards:a,cardElement:r=>e.jsx(H,{card:r})}):e.jsx(P,{})}function J({card:s}){return e.jsxs("div",{className:"group flex w-32 flex-col items-center rounded-lg",children:[e.jsx(_,{viewTransition:!0,to:`/card/${s.card_id}`,state:{card:s},children:e.jsx(T,{card:s,selected:!0})}),e.jsxs("p",{className:"max-w-[130px] overflow-hidden text-ellipsis whitespace-nowrap font-semibold text-[12px] pt-2",children:[s.card_id," - ",s.name]}),e.jsx("div",{className:"flex items-center gap-x-1",children:e.jsx("span",{className:"w-7 text-center border-none rounded",children:k[s.rarity]})})]})}function K(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(p,{children:"You have all tradeable cards!"}),e.jsx(w,{children:"Make sure you come back here when new rarities and packs are available for trade."})]})})}function Q(){const{ownedCards:s}=t.use(v),n=t.useMemo(()=>C.filter(a=>s.findIndex(r=>r.card_id===a.card_id)===-1||s[s.findIndex(r=>r.card_id===a.card_id)].amount_owned===0),[s]),o=t.useMemo(()=>E.filter(a=>a.tradeable).map(a=>a.id),[]),d=t.useMemo(()=>n.filter(a=>Object.keys(k).includes(a.rarity)&&o.includes(a.expansion)),[n]);return d&&d.length>0?e.jsx(M,{cards:d,cardElement:a=>e.jsx(J,{card:a})}):e.jsx(K,{})}function X(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(p,{children:"Sign up to view your tradeable cards"}),e.jsx(w,{children:"By registering, you can keep track of your collection, trade with other users, and access exclusive features."})]})})}function ne(){const{user:s}=t.use(S);return s?e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsxs(B,{defaultValue:"looking_for",children:[e.jsx("div",{className:"mx-auto max-w-[900px]",children:e.jsxs(I,{className:"w-full m-auto mt-4 mb-8 flex-wrap h-auto border-2 border-slate-600 rounded-md",children:[e.jsx(y,{value:"looking_for",children:"Looking For"}),e.jsx(y,{value:"for_trade",children:"For Trade"}),e.jsx(y,{value:"buying_tokens",children:"Buying Tokens"})]})}),e.jsxs("div",{className:"max-w-auto mx-4 md:mx-8",children:[e.jsx(N,{value:"looking_for",children:e.jsx(Q,{})}),e.jsx(N,{value:"for_trade",children:e.jsx(q,{})}),e.jsx(N,{value:"buying_tokens",children:e.jsx(U,{})})]})]})}):e.jsx(X,{})}export{ne as default};
