import{j as e,A as m,k as x,l as b,r as o,U as O,C as Y,w as G,i as P,t as j,x as M,y as q,B as $}from"./index-C80rc_0E.js";import{T as z,a as H,b as C,c as w,C as k}from"./tabs-BCDuUdha.js";import{N as _}from"./NumberFilter-CqLLb00b.js";import{R as J}from"./RarityFilter-BxjthIXb.js";import{S as h}from"./siren-BYDR5CoC.js";function Q(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(x,{children:"You have all tradeable cards!"}),e.jsx(b,{children:"Make sure you come back here when new rarities and packs are available for trade."})]})})}function W(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(x,{children:"You have no sellable cards!"}),e.jsx(b,{children:"If you believe you have sellable cards, go to the collections page and input your collected cards to see what you can sell."})]})})}function X(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(x,{children:"You have no tradeable cards!"}),e.jsx(b,{children:"Go to the collections page and input your collected cards to see what you can trade."})]})})}function Z(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(x,{children:"Sign up to view your tradeable cards"}),e.jsx(b,{children:"By registering, you can keep track of your collection, trade with other users, and access exclusive features."})]})})}function te(){const{user:S,account:y}=o.use(O),{ownedCards:n}=o.use(Y),{toast:I}=G(),[t,R]=o.useState([]),[f,B]=o.useState(0),[g,L]=o.useState(2),[p,U]=o.useState(3),[i,V]=o.useState("looking_for"),N=o.useMemo(()=>P.filter(a=>a.tradeable).map(a=>a.id),[]),l=o.useMemo(()=>j.filter(a=>n.findIndex(r=>r.card_id===a.card_id)===-1||n[n.findIndex(r=>r.card_id===a.card_id)].amount_owned<=f).filter(a=>Object.keys(M).includes(a.rarity)&&N.includes(a.expansion)),[n,f]),T=o.useMemo(()=>l.filter(a=>t.length===0||t.includes(a.rarity)),[l,t]),d=o.useMemo(()=>{const a=n.filter(r=>r.amount_owned>=g);return j.filter(r=>a.findIndex(s=>s.card_id===r.card_id)>-1).map(r=>{var s;return{...r,amount_owned:(s=a.find(u=>u.card_id===r.card_id))==null?void 0:s.amount_owned}}).filter(r=>Object.keys(M).includes(r.rarity)&&N.includes(r.expansion))},[n,g]),v=o.useMemo(()=>d.filter(a=>t.length===0||t.includes(a.rarity)),[d,t]),c=o.useMemo(()=>{const a=n.filter(r=>r.amount_owned>=p);return j.filter(r=>a.findIndex(s=>s.card_id===r.card_id)>-1).map(r=>{var s;return{...r,amount_owned:(s=a.find(u=>u.card_id===r.card_id))==null?void 0:s.amount_owned}}).filter(r=>Object.keys(q).includes(r.rarity))},[n,p]),A=o.useMemo(()=>c.filter(a=>t.length===0||t.includes(a.rarity)),[c,t]),F=()=>{let a=`Looking for cards:
`;return a+=T.sort((r,s)=>r.rarity.localeCompare(s.rarity)).map(r=>`${r.rarity} ${r.card_id} - ${r.name}`).join(`
`),a+=`

For trade cards:
`,a+=v.sort((r,s)=>r.rarity.localeCompare(s.rarity)).map(r=>`${r.rarity} ${r.card_id} - ${r.name}`).join(`
`),a},D=async a=>{a.preventDefault();const r=F();I({title:"Copied cards for trading to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(r)},E=async()=>{const a=y?` - ${y.username} - ${y.friend_id}`:"",r=encodeURIComponent(`Trade cards${a}`),s=encodeURIComponent(F()),K=`https://community.tcgpocketcollectiontracker.com/new-topic?title=${r}&body=${s}&category=Trading`;window.open(K,"_blank")};return S?e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsxs(z,{defaultValue:i,onValueChange:a=>V(a),children:[e.jsxs("div",{className:"mx-auto max-w-[900px] flex flex-row flex-wrap align-center gap-4 p-8",children:[e.jsxs(H,{className:"flex-grow m-auto flex-wrap h-auto border-2 border-slate-600 rounded-md",children:[e.jsx(C,{value:"looking_for",children:"Looking For"}),e.jsx(C,{value:"for_trade",children:"For Trade"}),e.jsx(C,{value:"buying_tokens",children:"Buying Tokens"})]}),e.jsx(J,{rarityFilter:t,setRarityFilter:R}),i==="looking_for"&&e.jsx(_,{numberFilter:f,setNumberFilter:B,options:[0,1,2,3,4,5],labelKey:"maxNum"}),i==="for_trade"&&e.jsx(_,{numberFilter:g,setNumberFilter:L,options:[2,3,4,5],labelKey:"minNum"}),i==="buying_tokens"&&e.jsx(_,{numberFilter:p,setNumberFilter:U,options:[2,3,4,5],labelKey:"minNum"}),e.jsx($,{variant:"outline",onClick:a=>D(a),children:"Copy to clipboard"}),e.jsx($,{variant:"outline",onClick:()=>E(),children:"Post to community"})]}),e.jsxs("div",{className:"max-w-auto mx-4 md:mx-8",children:[e.jsx(w,{value:"looking_for",children:l&&l.length>0?e.jsx(k,{cards:T}):e.jsx(Q,{})}),e.jsx(w,{value:"for_trade",children:d&&d.length>0?e.jsx(k,{cards:v}):e.jsx(X,{})}),e.jsx(w,{value:"buying_tokens",children:c&&c.length>0?e.jsx(k,{cards:A}):e.jsx(W,{})})]})]})}):e.jsx(Z,{})}export{te as default};
