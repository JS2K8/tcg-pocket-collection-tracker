const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TradeMatches-BQrhQecE.js","assets/index-ClBdhvJl.js","assets/index-Op30Na-E.css","assets/SocialShareButtons-BD6pPX7X.js","assets/index-CG_SfYXH.js","assets/RarityFilter-7cNNUyUw.js","assets/index--5DprvMB.js"])))=>i.map(i=>d[i]);
import{c as _e,j as e,l as F,m as L,u as I,r as x,B as S,D as de,n as ue,o as he,q as xe,M as Ie,s as Ae,t as me,I as Be,U as pe,C as G,v as De,w as Ee,x as Le,y as Pe,z as fe,A as He,k as Re,S as $e,E as Oe,F as ze,G as Fe,H as Ue,J as qe,K as Ve,L as We,N as Ge,O as Ze,Q as Ke,_ as Qe}from"./index-ClBdhvJl.js";import{T as ge,a as we,b as R,u as Je,C as Ye,c as Xe}from"./CardDetail-DGVrN17j.js";import{F as Z,P as et,u as tt}from"./Card-BGSOnckM.js";import{A as je,b as Ce,a as at}from"./alert-CB4NYgDK.js";import{M as W,C as ye,E as ne,D as nt,u as st}from"./index--5DprvMB.js";import{T as rt,a as se,P as lt,b as ot,c as it,R as re,N as le}from"./RarityFilter-7cNNUyUw.js";import{S as ct}from"./siren-BJECBQEL.js";import"./index-CG_SfYXH.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]],ut=_e("trophy",dt);function ht({card:n,onSelect:l,selected:t}){const r=()=>{l(n.card_id,!t)};return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Z,{card:n,selected:t,setIsSelected:r,size:"small"}),e.jsx("p",{className:"text-xs text-center mt-1",children:F(n,L.language)})]})}const xt=({children:n,className:l})=>e.jsx("div",{className:`max-h-[300px] overflow-y-auto border border-gray-300 rounded-md ${l}`,style:{maxHeight:"300px"},children:n});function mt({filteredCards:n,onBatchUpdate:l}){const{t}=I("bulk-update"),[r,h]=x.useState(!1),[s,o]=x.useState(0),[c,p]=x.useState({}),[v,w]=x.useState(!1),[y,C]=x.useState(!1),f=n.length===0,b=x.useMemo(()=>n.reduce((d,u)=>(d.some(g=>g.card_id===u.card_id)||d.push(u),d),[]),[n]);x.useEffect(()=>{if(r){const d=b.reduce((u,g)=>(u[g.card_id]=!0,u),{});p(d)}r||C(!1)},[r]);const T=(d,u)=>{p(g=>({...g,[d]:u}))},M=()=>{const d=b.reduce((u,g)=>(u[g.card_id]=!0,u),{});p(d)},N=()=>{const d=b.reduce((u,g)=>(u[g.card_id]=!1,u),{});p(d)},A=Object.values(c).filter(d=>d).length,k=()=>{s!==null&&(s>0?o(d=>(d||0)-1):s===0&&o(0)),C(!0)},E=()=>{o(d=>d?d+1:1),C(!0)},B=d=>{const u=d.target.value.trim();if(u==="")o(0);else{const g=Number(u);Number.isNaN(g)?o(0):o(g<0?0:g)}C(!0)},P=async()=>{w(!0);const d=Object.entries(c).filter(([u,g])=>g).map(([u])=>u);d.length>0&&(await l(d,s),h(!1),w(!1))};return e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"hidden sm:block",variant:"outline",onClick:()=>h(!0),disabled:f,children:t("buttonTitle")}),e.jsx(de,{open:r,onOpenChange:h,children:e.jsxs(ue,{className:"max-w-2xl",children:[e.jsx(he,{children:e.jsx(xe,{children:t("title")})}),e.jsx(je,{variant:"destructive",children:e.jsxs(Ce,{children:[t("alert.beforeCount"),e.jsxs("strong",{children:[e.jsx("span",{style:{fontSize:"1.25rem",color:"#f3f4f6",padding:"0.25rem 0.5rem",borderRadius:"0.375rem",margin:"0 0.25rem"},children:A})," ",t("alert.cards")]})," ",t("alert.afterCount"),e.jsx("strong",{children:t("alert.warning")})]})}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(S,{variant:"outline",onClick:N,children:t("deselectAll")}),e.jsx(S,{variant:"outline",onClick:M,children:t("selectAll")})]}),e.jsx(xt,{className:"h-64 rounded-md border p-4",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:b.map(d=>e.jsx(ht,{card:d,onSelect:T,selected:c[d.card_id]},d.card_id))})}),e.jsxs("div",{className:"flex items-center gap-x-1 justify-center",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:k,disabled:s===null||s===0,className:"rounded-full",children:e.jsx(Ie,{size:14})}),e.jsx("input",{type:"text",min:"0",value:s??0,onChange:B,placeholder:t("enterAmount"),className:"w-7 text-center border-none rounded",onFocus:d=>d.target.select()}),e.jsx(S,{variant:"ghost",size:"icon",onClick:E,className:"rounded-full",children:e.jsx(et,{size:14})})]}),e.jsxs(Ae,{children:[e.jsx(S,{variant:"outline",onClick:()=>h(!1),children:t("cancel")}),e.jsxs(S,{onClick:P,disabled:A===0||v||!y,variant:"default",children:[v&&e.jsxs("svg",{"aria-hidden":"true",className:"w-8 h-8 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),e.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]}),t(v?"batchProcessing":"batchUpdate")]})]})]})})]})}const oe=({ownedFilter:n,setOwnedFilter:l,fullWidth:t})=>{const{t:r}=I("owned-filter");return e.jsx(ge,{value:n,onValueChange:h=>l(h),className:t?"w-full":"w-70",children:e.jsxs(we,{className:"w-full flex-wrap h-auto lg:h-10 bg-neutral-50 border-1 border-neutral-700 rounded-md",children:[e.jsx(R,{value:"all",children:r("all")}),e.jsx(R,{value:"missing",children:r("missing")}),e.jsx(R,{value:"owned",children:r("owned")})]})})},ie=({value:n,onChange:l,expansion:t,fullWidth:r})=>{var c;const{t:h}=I("common/packs");let s=(c=me(t))==null?void 0:c.packs;const o=!(s===void 0||t==="P-A");return(s===void 0||s.length<=1)&&(s=[]),t==="all"||t==="P-A"?null:e.jsx(ge,{value:n,onValueChange:l,className:`h-auto ${r?"w-full":"w-[440px]"}`,children:e.jsxs(we,{className:"h-full flex-wrap w-full border-1 border-neutral-700 rounded-md flex-row justify-start content-start",children:[e.jsx(R,{value:"all",children:h("all")}),s.filter(p=>p.name!=="everypack").map(p=>e.jsx(R,{value:p.name,children:h(p.name)},`tab_trigger_${p.name}`)),o&&e.jsx(R,{value:"missions",children:h("missions")})]})})};let V=null;const ce=({setSearchValue:n,fullWidth:l})=>{const{t}=I("search-input");return e.jsx(Be,{type:"search",placeholder:t("search"),className:`w-full ${l?"":"sm:w-32"} border-2 h-[38px] bg-neutral-800`,style:{borderColor:"#45556C"},onChange:r=>{V&&window.clearTimeout(V),V=window.setTimeout(()=>{n(r.target.value)},500)}})};function pt(n,l){if(n.length===0)return l.length;if(l.length===0)return n.length;let t=Array(n.length+1).fill(0).map((h,s)=>s),r=Array(n.length+1);for(let h=1;h<=l.length;h++){r[0]=h;for(let s=1;s<=n.length;s++){const o=n[s-1]===l[h-1]?0:1;r[s]=Math.min(t[s]+1,r[s-1]+1,t[s-1]+o)}[t,r]=[r,t]}return t[n.length]}const ft=({allTextSearch:n,setAllTextSearch:l})=>{const{t}=I("search-input");return e.jsxs("div",{className:"flex items-center space-x-2 text-white/50",children:[e.jsx("input",{type:"checkbox",id:"checkbox",checked:n,onChange:()=>l(!n),className:"w-4 h-4"}),e.jsx("label",{htmlFor:"checkbox",className:"text-xs",children:t("allTextLabel")}),e.jsx(W,{id:"allTextSearch",style:{maxWidth:"300px",whiteSpace:"normal"},clickable:!0}),e.jsx(ye,{className:"h-4 w-4","data-tooltip-id":"allTextSearch","data-tooltip-content":t("allTextTooltip")})]})},gt=["grass","fire","water","lightning","psychic","fighting","darkness","metal","dragon","colorless","trainer",""],wt=({cardTypeFilter:n,setCardTypeFilter:l,collapse:t})=>{const{t:r}=I("card-type-filter"),h=x.useMemo(()=>e.jsxs(rt,{variant:"outline",type:"multiple",size:"sm",value:n,onValueChange:s=>{l(s)},className:`justify-center shadow-none border-1 border-neutral-700 rounded-md flex-wrap ${t?"flex-col":"flex-row"}`,children:[gt.filter(s=>s!==""&&s!=="trainer").map(s=>e.jsx(se,{value:s,"aria-label":s,className:"text-gray-400 hover:text-gray-500 px-1",children:e.jsx("img",{src:`/images/energy/${s}.webp`,alt:s,className:"h-4"})},s)),e.jsx(se,{value:"trainer","aria-label":"trainer",className:"text-gray-400 hover:text-gray-500 px-1",children:"T"})]}),[n,t]);return t?e.jsxs(lt,{children:[e.jsx(ot,{asChild:!0,children:e.jsxs(S,{variant:"outline",children:[r("filters")," (",n.length,")"]})}),e.jsx(it,{className:"w-32",children:h})]}):h},jt=({sortBy:n,setSortBy:l})=>{const{t}=I("sort-by");return e.jsx("div",{className:"px-3 py-1 border-1 border-neutral-700 rounded-md",children:e.jsxs("label",{className:"flex items-center gap-x-2 text-white/50 text-sm",children:[e.jsx("h2",{children:t("sortBy")}),e.jsxs("select",{value:n,onChange:r=>l(r.target.value),className:"p-1",children:[e.jsx("option",{value:"default",className:"text-black",children:t("default")}),e.jsx("option",{value:"recent",className:"text-black",children:t("recent")})]})]})})},Ct=({children:n,cards:l,filters:t,setFilters:r,onFiltersChanged:h,onChangeToMissions:s,visibleFilters:o,filtersDialog:c,batchUpdate:p,share:v})=>{const{t:w}=I(["pages/collection"]),{user:y,setIsProfileDialogOpen:C}=x.useContext(pe),{ownedCards:f,setOwnedCards:b}=x.useContext(G),[T,M]=x.useState(L.language),N=a=>r(m=>({...m,search:a})),A=a=>r(m=>({...m,allTextSearch:a})),k=a=>r(m=>({...m,expansion:a})),E=a=>r(m=>({...m,pack:a})),B=a=>r(m=>({...m,cardType:a})),P=a=>r(m=>({...m,rarity:a})),d=a=>r(m=>({...m,owned:a})),u=a=>r(m=>({...m,sortBy:a})),g=a=>r(m=>({...m,minNumber:a})),be=a=>r(m=>({...m,maxNumber:a})),Ne=a=>r(m=>({...m,deckbuildingMode:a})),ve=a=>t.rarity.length===0?!0:a.rarity!==""&&t.rarity.includes(a.rarity),ke=a=>t.cardType.length===0?!0:a.card_type.toLowerCase()==="trainer"?t.cardType.includes("trainer"):a.energy!==""&&t.cardType.includes(a.energy.toLowerCase()),H=x.useMemo(()=>{var Q;if(!l)return null;let a=De;if(t.deckbuildingMode&&(a=a.filter(i=>Ee.includes(i.rarity)||i.rarity===""||i.rarity==="P")),t.expansion!=="all"&&(a=a.filter(i=>i.expansion===t.expansion)),t.pack==="missions"){a=[];let i=((Q=Le.get(t.expansion))==null?void 0:Q.missions)||null;i&&(t.owned==="owned"?i=i.filter(j=>j.completed):t.owned==="missing"&&(i=i.filter(j=>!j.completed))),s(i)}else s(null),t.pack!=="all"&&(a=a.filter(i=>i.pack===t.pack||i.pack==="everypack"));t.owned!=="all"&&(t.owned==="owned"?a=a.filter(i=>l.find(j=>j.card_id===i.card_id&&j.amount_owned>0)):t.owned==="missing"&&(a=a.filter(i=>!l.find(j=>j.card_id===i.card_id&&j.amount_owned>0)))),t.sortBy==="recent"&&(a=[...a].sort((i,j)=>{var $,z;const D=($=l.find(O=>O.card_id===i.card_id))==null?void 0:$.updated_at,_=(z=l.find(O=>O.card_id===j.card_id))==null?void 0:z.updated_at;return D&&_?new Date(_).getTime()-new Date(D).getTime():D&&!_?-1:1})),a=a.filter(ve),a=a.filter(ke),t.search&&(a=a.filter(j=>{var J,Y;const D=F(j,L.language).toLowerCase(),_=t.search.toLowerCase();let $=!1;if(t.allTextSearch){const U=(J=j.ability.name)==null?void 0:J.toLowerCase(),Me=(Y=j.ability.effect)==null?void 0:Y.toLowerCase();$=U&&U!=="no ability"&&(U.includes(_)||Me.includes(_))||j.attacks.some(q=>{var X,ee,te,ae;return((X=q.name)==null?void 0:X.toLowerCase().includes(_))||((ee=q.effect)==null?void 0:ee.toLowerCase())!=="no effect"&&((ae=(te=q.effect)==null?void 0:te.toLowerCase())==null?void 0:ae.includes(_))})}const z=D.includes(_),O=pt(D,_)<=2,Te=j.card_id.toLowerCase().includes(_);return $||z||O||Te}));const m=new Map(f.map(i=>[i.card_id,i.amount_owned]));for(const i of a)i.linkedCardID?i.amount_owned=0:t.deckbuildingMode?i.amount_owned=i.alternate_versions.reduce((j,D)=>j+(m.get(D.card_id)||0),0):i.amount_owned=m.get(i.card_id)||0;return a=a.filter(i=>(i.amount_owned||0)>=t.minNumber),t.maxNumber!==100&&(a=a.filter(i=>(i.amount_owned||0)<=t.maxNumber)),a},[l,t,T]);x.useEffect(()=>{h(H);const a=m=>{M(m)};return L.on("languageChanged",a),()=>{L.off("languageChanged",a)}},[H]);const Se=async(a,m)=>{await tt(a,m,f,b,y)};function K(a){k(a),E("all")}return e.jsxs("div",{id:"filterbar",className:"flex flex-col gap-x-2 flex-wrap",children:[n,(o==null?void 0:o.expansions)&&e.jsxs("div",{className:"flex gap-x-2 px-4 mb-2",children:[e.jsx(ne,{value:t.expansion,onChange:K}),e.jsx(ie,{value:t.pack,onChange:E,expansion:t.expansion})]}),e.jsxs("div",{className:"gap-2 flex-row gap-y-1 px-4 flex",children:[(o==null?void 0:o.search)&&e.jsx(ce,{setSearchValue:N}),(o==null?void 0:o.owned)&&e.jsx(oe,{ownedFilter:t.owned,setOwnedFilter:d}),(o==null?void 0:o.rarity)&&e.jsx(re,{rarityFilter:t.rarity,setRarityFilter:P,collapse:!0}),c&&e.jsxs(de,{children:[e.jsx(Pe,{asChild:!0,children:e.jsx(S,{variant:"outline",children:w("filters.allFilters")})}),e.jsxs(ue,{className:"border-1 border-neutral-700 shadow-none max-h-[90vh] overflow-y-auto content-start",children:[e.jsx(he,{children:e.jsx(xe,{children:w("filters.filtersCount",{count:(H||[]).filter(a=>!a.linkedCardID).length})})}),e.jsxs("div",{className:"flex flex-col gap-3",children:[c.search&&e.jsx(ce,{setSearchValue:N,fullWidth:!0}),c.allTextSearch&&e.jsx(ft,{allTextSearch:t.allTextSearch,setAllTextSearch:A}),c.expansions&&e.jsx(ne,{value:t.expansion,onChange:K}),c.pack&&e.jsx(ie,{value:t.pack,onChange:E,expansion:t.expansion,fullWidth:!0}),c.rarity&&e.jsx(re,{rarityFilter:t.rarity,setRarityFilter:P}),c.cardType&&e.jsx(wt,{cardTypeFilter:t.cardType,setCardTypeFilter:B}),c.owned&&e.jsx(oe,{ownedFilter:t.owned,setOwnedFilter:d,fullWidth:!0}),c.sortBy&&e.jsx(jt,{sortBy:t.sortBy,setSortBy:u}),c.amount&&e.jsxs(e.Fragment,{children:[e.jsx(le,{numberFilter:t.minNumber,setNumberFilter:g,options:[0,1,2,3,4,5,6,7,8,9],labelKey:"minNum"}),e.jsx(le,{numberFilter:t.maxNumber,setNumberFilter:be,options:[1,2,3,4,5,6,7,8,9,10,100],labelKey:"maxNum"})]}),c.deckBuildingMode&&e.jsx(nt,{deckbuildingMode:t.deckbuildingMode,setDeckbuildingMode:Ne}),e.jsx(S,{variant:"outline",className:"!text-red-700",onClick:()=>r({search:"",expansion:"all",pack:"all",cardType:[],rarity:[],owned:"all",sortBy:"default",minNumber:0,maxNumber:100,deckbuildingMode:!1,allTextSearch:!1}),children:w("filters.clear")})]})]})]}),p&&e.jsx(mt,{filteredCards:H||[],onBatchUpdate:Se,disabled:!H||H.length===0}),v&&e.jsx(S,{variant:"outline",onClick:()=>C(!0),children:w("filters.share")})]})]})};function yt({mission:n}){const{width:l}=Je(),{t}=I("common/packs"),{ownedCards:r,setSelectedCardId:h,setSelectedMissionCardOptions:s}=x.use(G);let o=5,c=Math.min(l,890)/5+120;l>600&&l<800?(o=4,c=l/3+50):l<=600&&(o=3,c=l/3+100);const p=x.useMemo(()=>{let w=!0;const y=n.requiredCards.flatMap(f=>{let b=r.reduce((M,N)=>{const A=f.options.find(k=>k===N.card_id);if(A)for(let k=0;k<N.amount_owned;k++)M.push({cardId:A,owned:!0,missionCardOptions:f.options});return M},[]);b.length>f.amount&&(b=b.slice(0,f.amount));const T=f.amount-b.length;for(let M=0;M<T;M++)b.push({cardId:f.options[0],owned:!1,missionCardOptions:f.options});return w=w&&T===0,b});n.completed=w;const C=[];for(let f=0;f<y.length;f+=o)C.push(y.slice(f,f+o));return C},[o]),v=c*p.length+72;return e.jsxs("div",{style:{height:`${v}px`},className:"relative w-full",children:[e.jsx("div",{style:{height:`${v}px`},className:"relative w-full",children:p.map((w,y)=>e.jsx("div",{style:{height:`${c}px`,transform:`translateY(${c*y+72}px)`},className:"absolute top-0 left-0 w-full",children:e.jsx("div",{className:"flex justify-start gap-x-3",children:w.map(C=>{const f=fe(C.cardId);return f&&e.jsxs("div",{className:"group flex w-fit max-w-32 md:max-w-40 flex-col items-center rounded-lg cursor-pointer",children:[e.jsx("div",{onClick:()=>C.owned?h(C.cardId):s(C.missionCardOptions),children:e.jsx(Z,{card:f,selected:C.owned})}),e.jsxs("p",{className:"max-w-[130px] overflow-hidden text-ellipsis whitespace-nowrap font-semibold text-[12px] pt-2",children:[C.cardId," - ",F(f,L.language)]})]})})})},y))}),e.jsx("div",{style:{height:"72px"},className:"absolute top-0 left-0 w-full",children:e.jsxs("h2",{className:"flex items-center gap-x-4 mx-auto mt-10 w-full max-w-[900px] scroll-m-20 border-b-2 border-slate-600 pb-2 font-semibold text-md sm:text-lg md:text-2xl tracking-tight transition-colors first:mt-0",children:[n.name,e.jsx(W,{id:`rewardDescription${n.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),e.jsx(ut,{className:"h-6 w-6","data-tooltip-id":`rewardDescription${n.name}`,"data-tooltip-html":n.reward}),e.jsx(W,{id:`probability${n.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),e.jsx(ye,{className:"h-6 w-6","data-tooltip-id":`probability${n.name}`,"data-tooltip-html":n.completed?"Completed!":He(n,p).filter(([w,y])=>w!=="everypack"&&y>0).map(([w,y])=>`${t(w)}: ${y.toFixed(2)}%`).join("<br/>")})]})},"header")]})}function bt({missions:n,resetScrollTrigger:l}){const t=x.useRef(null),[r,h]=x.useState("auto");return x.useLayoutEffect(()=>{const s=()=>{var o,c;if(t.current){const p=((o=document.querySelector("#header"))==null?void 0:o.offsetHeight)||0,v=((c=document.querySelector("#filterbar"))==null?void 0:c.offsetHeight)||0,w=window.innerHeight-p-v;h(`${w}px`)}};return s(),window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]),x.useEffect(()=>{t.current&&(t.current.scrollTop=0)},[l]),e.jsx("div",{ref:t,className:"overflow-y-auto mt-2 sm:mt-4 px-4 flex flex-col justify-start",style:{scrollbarWidth:"none",height:r},children:n.map(s=>e.jsx(yt,{mission:s},s.name))})}function Nt({missionCardOptions:n,onClose:l}){const{t}=I(["common/sets","common/packs","pages/collection"]),r=n[0]||"",h=r.length>0?r.split("-")[0]:"Unknown",s=me(h)||Re[0],o=s.name;return e.jsx($e,{open:!!n.length,onOpenChange:c=>{c||l()},children:e.jsxs(Oe,{className:"transition-all duration-300 ease-in-out border-slate-600 overflow-y-auto",children:[e.jsx(ze,{children:e.jsx(Fe,{children:n.length===1?t("missionDetail.eligibleCards-singular",{ns:"pages/collection",options:1}):t("missionDetail.eligibleCards-plural",{ns:"pages/collection",options:n.length})})}),t(o),n.map(c=>{const p=fe(c);return p&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"px-10 py-4 w-full",children:e.jsx(Z,{card:p,selected:!1})}),e.jsxs("p",{className:"max-w-[130px] whitespace-nowrap font-semibold text-[12px] pt-2",children:[c," - ",F(p,L.language),e.jsx("br",{}),t("missionDetail.chanceFrom",{ns:"pages/collection",pack:t(p.pack,{ns:"common/packs"}),chance:Ue(s,p.pack,p).toFixed(2)})]})]})})]})})}const vt=Ke(()=>Qe(()=>import("./TradeMatches-BQrhQecE.js"),__vite__mapDeps([0,1,2,3,4,5,6])));function Dt(){const n=qe(),l=Ve(),t=We(),{t:r}=I(["pages/collection"]),h=st({query:"(max-width: 767px)"}),{ownedCards:s,selectedCardId:o,setSelectedCardId:c,selectedMissionCardOptions:p,setSelectedMissionCardOptions:v}=x.useContext(G),{account:w}=x.useContext(pe),[y,C]=x.useState({search:"",expansion:"all",pack:"all",cardType:[],rarity:[],owned:"all",sortBy:"default",minNumber:0,maxNumber:100,deckbuildingMode:!1,allTextSearch:!1}),[f,b]=x.useState(!1),[T,M]=x.useState(null),[N,A]=x.useState(null),[k,E]=x.useState(null),[B,P]=x.useState(null);x.useEffect(()=>{const u=n.friendId;u&&!N?(console.log("fetching collection by friend id",u),Ge(u).then(g=>{console.log("friend account",g),M(g)}).catch(console.error),Ze(void 0,u).then(g=>{g.length===0&&(console.log("not a public collection, going back to normal mode."),l("/collection")),A(g)}).catch(console.error)):!u&&N&&window.location.reload()},[n]),x.useEffect(()=>()=>{A(null)},[]);const d=x.useMemo(()=>n.friendId?N:s||[],[s,N]);return x.useEffect(()=>{b(!0);const u=setTimeout(()=>b(!1),100);return()=>clearTimeout(u)},[k]),e.jsxs("div",{className:"flex flex-col gap-y-1 mx-auto max-w-[900px]",children:[e.jsx(Ct,{cards:d,filters:y,setFilters:C,onFiltersChanged:u=>E(u),onChangeToMissions:u=>P(u),visibleFilters:{expansions:!h,allTextSearch:!h,search:!0,owned:!h,rarity:!h},filtersDialog:{expansions:!0,pack:!0,search:!0,owned:!0,sortBy:!0,rarity:!0,cardType:!0,amount:!0,deckBuildingMode:!0,allTextSearch:!0},batchUpdate:!N,share:!0,children:e.jsx("div",{children:N&&e.jsxs(je,{className:"mb-4 border-1 border-neutral-700 shadow-none",children:[e.jsx(ct,{className:"h-4 w-4"}),e.jsx(at,{children:r("publicCollectionTitle",{username:T==null?void 0:T.username})}),e.jsx(Ce,{children:e.jsxs("div",{className:"flex items-center",children:[r("publicCollectionDescription"),e.jsx(S,{className:"mb-4",onClick:()=>{l(`${t.pathname}/trade`)},children:r("showPossibleTrades")})]})})]})})}),e.jsxs("div",{children:[k&&!B&&e.jsx(Ye,{cards:k,resetScrollTrigger:f,showStats:!y.deckbuildingMode,extraOffset:24,editable:!y.deckbuildingMode}),o&&e.jsx(Xe,{cardId:o,onClose:()=>c("")})]}),e.jsx("div",{children:B&&e.jsx(bt,{missions:B,resetScrollTrigger:f})}),B&&e.jsx(Nt,{missionCardOptions:p,onClose:()=>v([])}),e.jsx(vt,{ownedCards:s,friendCards:N||[],ownAccount:w,friendAccount:T})]})}export{Dt as default};
