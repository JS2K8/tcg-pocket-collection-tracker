import{K as N,r as T,U as w,b1 as C,u as F,b2 as y,b3 as I,b4 as j,j as e,D as P,n as k,o as B,q as E,I as u,B as x,b5 as A}from"./index-CRCNQJHB.js";import{A as U,a as $,b as L}from"./alert-DvwetFAM.js";import{u as R,F as q,a as l,b as t,c as o,d as c,e as d,f as b,S as H,g as K,s as M}from"./SocialShareButtons-DFrcSmO6.js";import{S as z}from"./siren-CClNLaue.js";import"./index-4exMkN9e.js";const W=({account:i,setAccount:f,isProfileDialogOpen:g,setIsProfileDialogOpen:h})=>{const v=N(),{user:p}=T.use(w),{toast:m}=C(),{t:s}=F("edit-profile"),_=y({username:j().min(2,{message:s("usernameTooShort")}),friend_id:j().regex(/^[0-9]{16}$/,{message:s("friendIdInvalid")}),is_public:I().optional()}),n=R({resolver:M(_),values:{username:i?.username||"",friend_id:i?.friend_id||"",is_public:i?.is_public||!1}}),D=async r=>{try{const a=await A.from("accounts").upsert({email:p?.user.email,username:r.username,friend_id:r.friend_id,is_public:r.is_public}).select().single();f(a.data),m({title:s("accountSaved"),variant:"default"})}catch(a){console.error("error saving account",a),m({title:s("accountSavingError"),variant:"destructive"})}},S=`https://tcgpocketcollectiontracker.com/#/collection/${i?.friend_id}`;return e.jsx(P,{open:g,onOpenChange:h,children:e.jsxs(k,{className:"border-1 border-neutral-700 shadow-none h-[90vh] content-start",children:[e.jsx(B,{children:e.jsx(E,{children:s("editProfile")})}),e.jsxs(U,{className:"mb-2 border-1 border-neutral-700 shadow-none",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx($,{children:s("updateProfile.title")}),e.jsx(L,{children:s("updateProfile.description")})]}),e.jsx(q,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(D),className:"space-y-8",children:[e.jsx(l,{name:"email",render:()=>e.jsxs(t,{children:[e.jsx(o,{children:s("email")}),e.jsx(c,{className:"mt-2",children:e.jsx(u,{placeholder:s("email"),disabled:!0,value:p?.user.email})}),e.jsx(d,{children:s("registeredEmail")})]})}),e.jsx(l,{control:n.control,name:"username",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:s("username")}),e.jsx(c,{className:"mt-2",children:e.jsx(u,{placeholder:s("username"),...r})}),e.jsx(d,{children:s("usernameDescription")}),e.jsx(b,{})]})}),e.jsx(l,{control:n.control,name:"friend_id",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:s("friendID")}),e.jsx(c,{className:"mt-2",children:e.jsx(u,{placeholder:s("friendID"),...r})}),e.jsx(d,{children:s("friendIDDescription")}),e.jsx(b,{})]})}),e.jsx(l,{control:n.control,name:"is_public",render:({field:r})=>e.jsxs(t,{className:"flex flex-col items-start",children:[e.jsx(c,{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-x-2 w-full flex-wrap",children:[e.jsx(o,{children:s("isPublicToggle")}),e.jsx("div",{className:"grow-1",children:e.jsx(H,{checked:r.value,onCheckedChange:r.onChange})}),e.jsx(x,{disabled:!i?.is_public,onClick:async a=>{a.preventDefault(),m({title:"Copied public collection page URL to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(S)},children:s("isPublicButton")}),e.jsx(x,{disabled:!i?.is_public,onClick:async a=>{a.preventDefault(),h(!1),v(`/collection/${i?.friend_id}/trade`)},children:s("isPublicTradeButton")})]})}),e.jsx(d,{children:s("isPublicDescription")})]})}),i?.is_public&&e.jsx(K,{}),e.jsx(x,{type:"submit",children:s("save")})]})})]})})};export{W as default};
