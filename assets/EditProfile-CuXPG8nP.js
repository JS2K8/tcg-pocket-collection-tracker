import{K as N,r as T,U as w,b1 as C,u as F,b2 as y,b3 as I,b4 as b,j as e,D as P,n as k,o as B,q as E,I as p,B as c,b5 as A}from"./index-BnFUEHJL.js";import{A as U,a as $,b as L}from"./alert-Ct7rWWXb.js";import{u as R,F as q,a as t,b as d,c as o,d as m,e as x,f,S as H,g as K,s as M}from"./SocialShareButtons-DwEHxPm6.js";import{S as z}from"./siren-BTdmXTgn.js";import"./index-BGkhWcHN.js";const W=({account:s,setAccount:g,isProfileDialogOpen:u,setIsProfileDialogOpen:j})=>{const v=N(),{user:a}=T.use(w),{toast:h}=C(),{t:r}=F("edit-profile"),_=y({username:b().min(2,{message:r("usernameTooShort")}),friend_id:b().regex(/^[0-9]{16}$/,{message:r("friendIdInvalid")}),is_public:I().optional()}),n=R({resolver:M(_),values:{username:(s==null?void 0:s.username)||"",friend_id:(s==null?void 0:s.friend_id)||"",is_public:(s==null?void 0:s.is_public)||!1}}),D=async i=>{try{const l=await A.from("accounts").upsert({email:a==null?void 0:a.user.email,username:i.username,friend_id:i.friend_id,is_public:i.is_public}).select().single();g(l.data),h({title:r("accountSaved"),variant:"default"})}catch(l){console.error("error saving account",l),h({title:r("accountSavingError"),variant:"destructive"})}},S=`https://tcgpocketcollectiontracker.com/#/collection/${s==null?void 0:s.friend_id}`;return e.jsx(P,{open:u,onOpenChange:j,children:e.jsxs(k,{className:"border-1 border-neutral-700 shadow-none h-[90vh] content-start",children:[e.jsx(B,{children:e.jsx(E,{children:r("editProfile")})}),e.jsxs(U,{className:"mb-2 border-1 border-neutral-700 shadow-none",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx($,{children:r("updateProfile.title")}),e.jsx(L,{children:r("updateProfile.description")})]}),e.jsx(q,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(D),className:"space-y-8",children:[e.jsx(t,{name:"email",render:()=>e.jsxs(d,{children:[e.jsx(o,{children:r("email")}),e.jsx(m,{className:"mt-2",children:e.jsx(p,{placeholder:r("email"),disabled:!0,value:a==null?void 0:a.user.email})}),e.jsx(x,{children:r("registeredEmail")})]})}),e.jsx(t,{control:n.control,name:"username",render:({field:i})=>e.jsxs(d,{children:[e.jsx(o,{children:r("username")}),e.jsx(m,{className:"mt-2",children:e.jsx(p,{placeholder:r("username"),...i})}),e.jsx(x,{children:r("usernameDescription")}),e.jsx(f,{})]})}),e.jsx(t,{control:n.control,name:"friend_id",render:({field:i})=>e.jsxs(d,{children:[e.jsx(o,{children:r("friendID")}),e.jsx(m,{className:"mt-2",children:e.jsx(p,{placeholder:r("friendID"),...i})}),e.jsx(x,{children:r("friendIDDescription")}),e.jsx(f,{})]})}),e.jsx(t,{control:n.control,name:"is_public",render:({field:i})=>e.jsxs(d,{className:"flex flex-col items-start",children:[e.jsx(m,{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-x-2 w-full flex-wrap",children:[e.jsx(o,{children:r("isPublicToggle")}),e.jsx("div",{className:"grow-1",children:e.jsx(H,{checked:i.value,onCheckedChange:i.onChange})}),e.jsx(c,{disabled:!(s!=null&&s.is_public),onClick:async l=>{l.preventDefault(),h({title:"Copied public collection page URL to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(S)},children:r("isPublicButton")}),e.jsx(c,{disabled:!(s!=null&&s.is_public),onClick:async l=>{l.preventDefault(),j(!1),v(`/collection/${s==null?void 0:s.friend_id}/trade`)},children:r("isPublicTradeButton")})]})}),e.jsx(x,{children:r("isPublicDescription")})]})}),(s==null?void 0:s.is_public)&&e.jsx(K,{}),e.jsx(c,{type:"submit",children:r("save")})]})})]})})};export{W as default};
