import{j as e,A as m,k as x,l as b,r as t,U as O,C as Y,w as G,i as P,t as C,x as M,y as q,B as $}from"./index-C29qCDso.js";import{T as z,a as H,b as w,c as k,C as _}from"./tabs-BSBlZEI7.js";import{N}from"./NumberFilter-7nXBHV9r.js";import{R as J}from"./RarityFilter-DDOAjj6Z.js";import{S as y}from"./siren-CthLeZyq.js";function Q(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(x,{children:"You have all tradeable cards!"}),e.jsx(b,{children:"Make sure you come back here when new rarities and packs are available for trade."})]})})}function W(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(x,{children:"You have no sellable cards!"}),e.jsx(b,{children:"If you believe you have sellable cards, go to the collections page and input your collected cards to see what you can sell."})]})})}function X(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(x,{children:"You have no tradeable cards!"}),e.jsx(b,{children:"Go to the collections page and input your collected cards to see what you can trade."})]})})}function Z(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(m,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(x,{children:"Sign up to view your tradeable cards"}),e.jsx(b,{children:"By registering, you can keep track of your collection, trade with other users, and access exclusive features."})]})})}function oe(){const{user:S,account:f}=t.use(O),{ownedCards:n}=t.use(Y),{toast:I}=G(),[o,R]=t.useState([]),[h,L]=t.useState(0),[g,B]=t.useState(2),[p,U]=t.useState(3),[l,V]=t.useState("looking_for"),T=t.useMemo(()=>P.filter(r=>r.tradeable).map(r=>r.id),[]),d=t.useMemo(()=>C.filter(r=>n.findIndex(a=>a.card_id===r.card_id)===-1||n[n.findIndex(a=>a.card_id===r.card_id)].amount_owned<=h).filter(r=>Object.keys(M).includes(r.rarity)&&T.includes(r.expansion)),[n,h]),j=t.useMemo(()=>d.filter(r=>o.length===0||o.includes(r.rarity)),[d,o]),c=t.useMemo(()=>{const r=n.filter(a=>a.amount_owned>=g);return C.filter(a=>r.findIndex(s=>s.card_id===a.card_id)>-1).map(a=>{var s;return{...a,amount_owned:(s=r.find(i=>i.card_id===a.card_id))==null?void 0:s.amount_owned}}).filter(a=>Object.keys(M).includes(a.rarity)&&T.includes(a.expansion))},[n,g]),F=t.useMemo(()=>c.filter(r=>o.length===0||o.includes(r.rarity)),[c,o]),u=t.useMemo(()=>{const r=n.filter(a=>a.amount_owned>=p);return C.filter(a=>r.findIndex(s=>s.card_id===a.card_id)>-1).map(a=>{var s;return{...a,amount_owned:(s=r.find(i=>i.card_id===a.card_id))==null?void 0:s.amount_owned}}).filter(a=>Object.keys(q).includes(a.rarity))},[n,p]),A=t.useMemo(()=>u.filter(r=>o.length===0||o.includes(r.rarity)),[u,o]),v=()=>{let r=`Looking for cards:
`;r+=j.sort((s,i)=>s.rarity.localeCompare(i.rarity)).map(s=>`${s.rarity} ${s.card_id} - ${s.name}`).join(`
`);const a=j.map(s=>s.rarity);return r+=`

For trade cards:
`,r+=F.filter(s=>a.includes(s.rarity)).sort((s,i)=>s.rarity.localeCompare(i.rarity)).map(s=>`${s.rarity} ${s.card_id} - ${s.name}`).join(`
`),r},D=async r=>{r.preventDefault();const a=v();I({title:"Copied cards for trading to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(a)},E=async()=>{const r=f?` - ${f.username} - ${f.friend_id}`:"",a=encodeURIComponent(`Trade cards${r}`),s=encodeURIComponent(v()),K=`https://community.tcgpocketcollectiontracker.com/new-topic?title=${a}&body=${s}&category=Trading`;window.open(K,"_blank")};return S?e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsxs(z,{defaultValue:l,onValueChange:r=>V(r),children:[e.jsxs("div",{className:"mx-auto max-w-[900px] flex flex-row flex-wrap align-center gap-4 p-8",children:[e.jsxs(H,{className:"flex-grow m-auto flex-wrap h-auto border-2 border-slate-600 rounded-md",children:[e.jsx(w,{value:"looking_for",children:"Looking For"}),e.jsx(w,{value:"for_trade",children:"For Trade"}),e.jsx(w,{value:"buying_tokens",children:"Buying Tokens"})]}),e.jsx(J,{rarityFilter:o,setRarityFilter:R}),l==="looking_for"&&e.jsx(N,{numberFilter:h,setNumberFilter:L,options:[0,1,2,3,4,5],labelKey:"maxNum"}),l==="for_trade"&&e.jsx(N,{numberFilter:g,setNumberFilter:B,options:[2,3,4,5],labelKey:"minNum"}),l==="buying_tokens"&&e.jsx(N,{numberFilter:p,setNumberFilter:U,options:[2,3,4,5],labelKey:"minNum"}),e.jsx($,{variant:"outline",onClick:r=>D(r),children:"Copy to clipboard"}),e.jsx($,{variant:"outline",onClick:()=>E(),children:"Post to community"})]}),e.jsxs("div",{className:"max-w-auto mx-4 md:mx-8",children:[e.jsx(k,{value:"looking_for",children:d&&d.length>0?e.jsx(_,{cards:j}):e.jsx(Q,{})}),e.jsx(k,{value:"for_trade",children:c&&c.length>0?e.jsx(_,{cards:F}):e.jsx(X,{})}),e.jsx(k,{value:"buying_tokens",children:u&&u.length>0?e.jsx(_,{cards:A}):e.jsx(W,{})})]})]})}):e.jsx(Z,{})}export{oe as default};
