import{j as e,A as y,k as b,l as g,r as o,U as G,C as P,w as q,i as z,t as k,x as I,y as H,B as E}from"./index-DKuMWKeH.js";import{T as J,a as Q,b as _,c as T,C as N}from"./tabs-IHktxGgQ.js";import{N as v}from"./NumberFilter-CFR569HC.js";import{R as W}from"./RarityFilter-BaudsdJ0.js";import{S as h}from"./siren-CWuWp-zB.js";function X(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(y,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(b,{children:"You have all tradeable cards!"}),e.jsx(g,{children:"Make sure you come back here when new rarities and packs are available for trade."})]})})}function Z(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(y,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(b,{children:"You have no sellable cards!"}),e.jsx(g,{children:"If you believe you have sellable cards, go to the collections page and input your collected cards to see what you can sell."})]})})}function ee(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(y,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(b,{children:"You have no tradeable cards!"}),e.jsx(g,{children:"Go to the collections page and input your collected cards to see what you can trade."})]})})}function re(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(y,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(b,{children:"Sign up to view your tradeable cards"}),e.jsx(g,{children:"By registering, you can keep track of your collection, trade with other users, and access exclusive features."})]})})}function ie(){const{user:R,account:c}=o.use(G),{ownedCards:l}=o.use(P),{toast:A}=q(),[i,L]=o.useState([]),[j,B]=o.useState(0),[C,U]=o.useState(2),[w,V]=o.useState(3),[u,D]=o.useState("looking_for"),F=o.useMemo(()=>z.filter(r=>r.tradeable).map(r=>r.id),[]),m=o.useMemo(()=>k.filter(r=>l.findIndex(a=>a.card_id===r.card_id)===-1||l[l.findIndex(a=>a.card_id===r.card_id)].amount_owned<=j).filter(r=>Object.keys(I).includes(r.rarity)&&F.includes(r.expansion)),[l,j]),x=o.useMemo(()=>m.filter(r=>i.length===0||i.includes(r.rarity)),[m,i]),p=o.useMemo(()=>{const r=l.filter(a=>a.amount_owned>=C);return k.filter(a=>r.findIndex(n=>n.card_id===a.card_id)>-1).map(a=>{var n;return{...a,amount_owned:(n=r.find(t=>t.card_id===a.card_id))==null?void 0:n.amount_owned}}).filter(a=>Object.keys(I).includes(a.rarity)&&F.includes(a.expansion))},[l,C]),M=o.useMemo(()=>p.filter(r=>i.length===0||i.includes(r.rarity)),[p,i]),f=o.useMemo(()=>{const r=l.filter(a=>a.amount_owned>=w);return k.filter(a=>r.findIndex(n=>n.card_id===a.card_id)>-1).map(a=>{var n;return{...a,amount_owned:(n=r.find(t=>t.card_id===a.card_id))==null?void 0:n.amount_owned}}).filter(a=>Object.keys(H).includes(a.rarity))},[l,w]),K=o.useMemo(()=>f.filter(r=>i.length===0||i.includes(r.rarity)),[f,i]),$=()=>{let r="";c!=null&&c.username&&(r+=`Account: ${c.username} - ${c.friend_id}

`),r+=`Looking for cards:
`;const a=x.sort((s,d)=>{const S=s.expansion.localeCompare(d.expansion);return S!==0?S:s.rarity.localeCompare(d.rarity)});for(let s=0;s<a.length;s++)(s>0?a[s-1].expansion:"")!==a[s].expansion&&(r+=`
${a[s].set_details}:
`),r+=`${a[s].rarity} ${a[s].card_id} - ${a[s].name}
`;const n=x.map(s=>s.rarity);r+=`

For trade cards:
`;const t=M.filter(s=>n.includes(s.rarity)).sort((s,d)=>s.rarity.localeCompare(d.rarity));for(let s=0;s<t.length;s++)(s>0?t[s-1].expansion:"")!==t[s].expansion&&(r+=`
${t[s].set_details}:
`),r+=`${t[s].rarity} ${t[s].card_id} - ${t[s].name}
`;return r},O=async r=>{r.preventDefault();const a=$();A({title:"Copied cards for trading to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(a)},Y=async()=>{const r=Array.from(new Set(x.map(d=>d.rarity))).join(", "),a=encodeURIComponent(`Trading cards ${r}`),n=encodeURIComponent($()),s=`https://community.tcgpocketcollectiontracker.com/new-topic?title=${a}&body=${n}&category=Trading`;window.open(s,"_blank")};return R?e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsxs(J,{defaultValue:u,onValueChange:r=>D(r),children:[e.jsxs("div",{className:"mx-auto max-w-[900px] flex flex-row flex-wrap align-center gap-4 p-8",children:[e.jsxs(Q,{className:"flex-grow m-auto flex-wrap h-auto border-2 border-slate-600 rounded-md",children:[e.jsx(_,{value:"looking_for",children:"Looking For"}),e.jsx(_,{value:"for_trade",children:"For Trade"}),e.jsx(_,{value:"buying_tokens",children:"Buying Tokens"})]}),e.jsx(W,{rarityFilter:i,setRarityFilter:L}),u==="looking_for"&&e.jsx(v,{numberFilter:j,setNumberFilter:B,options:[0,1,2,3,4,5],labelKey:"maxNum"}),u==="for_trade"&&e.jsx(v,{numberFilter:C,setNumberFilter:U,options:[2,3,4,5],labelKey:"minNum"}),u==="buying_tokens"&&e.jsx(v,{numberFilter:w,setNumberFilter:V,options:[2,3,4,5],labelKey:"minNum"}),e.jsx(E,{variant:"outline",onClick:r=>O(r),children:"Copy to clipboard"}),e.jsx(E,{variant:"outline",onClick:()=>Y(),children:"Post to community"})]}),e.jsxs("div",{className:"max-w-auto mx-4 md:mx-8",children:[e.jsx(T,{value:"looking_for",children:m&&m.length>0?e.jsx(N,{cards:x}):e.jsx(X,{})}),e.jsx(T,{value:"for_trade",children:p&&p.length>0?e.jsx(N,{cards:M}):e.jsx(ee,{})}),e.jsx(T,{value:"buying_tokens",children:f&&f.length>0?e.jsx(N,{cards:K}):e.jsx(Z,{})})]})]})}):e.jsx(re,{})}export{ie as default};
