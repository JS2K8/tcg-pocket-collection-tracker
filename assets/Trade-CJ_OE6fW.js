import{j as e,r as o,U as P,C as z,t as H,i as J,q as k,v as R,w as O,B as E}from"./index-DJXe-n9R.js";import{T as Q,a as W,b as T,c as N,C as v}from"./tabs-D5zgFKrN.js";import{N as F}from"./NumberFilter-BtER2lAp.js";import{R as X}from"./RarityFilter-B1QCY-bt.js";import{A as b,a as g,b as h}from"./alert-4SsGlKKo.js";import{S as y}from"./siren-Cls8CjF9.js";function Z(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(b,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(g,{children:"You have all tradeable cards!"}),e.jsx(h,{children:"Make sure you come back here when new rarities and packs are available for trade."})]})})}function ee(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(b,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(g,{children:"You have no sellable cards!"}),e.jsx(h,{children:"If you believe you have sellable cards, go to the collections page and input your collected cards to see what you can sell."})]})})}function re(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(b,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(g,{children:"You have no tradeable cards!"}),e.jsx(h,{children:"Go to the collections page and input your collected cards to see what you can trade."})]})})}function ae(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(b,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(g,{children:"Sign up to view your tradeable cards"}),e.jsx(h,{children:"By registering, you can keep track of your collection, trade with other users, and access exclusive features."})]})})}function de(){const{user:A,account:c}=o.use(P),{ownedCards:i}=o.use(z),{toast:L}=H(),[d,U]=o.useState([]),[j,B]=o.useState(0),[C,V]=o.useState(2),[w,D]=o.useState(3),[u,K]=o.useState("looking_for"),M=o.useMemo(()=>J.filter(r=>r.tradeable).map(r=>r.id),[]),_=r=>d.length===0?!0:r.rarity!=="Unknown"&&r.rarity!==""&&d.includes(r.rarity),m=o.useMemo(()=>k.filter(r=>i.findIndex(a=>a.card_id===r.card_id)===-1||i[i.findIndex(a=>a.card_id===r.card_id)].amount_owned<=j).filter(r=>R[r.rarity]!==null&&M.includes(r.expansion)),[i,j]),x=o.useMemo(()=>m.filter(_),[m,d]),p=o.useMemo(()=>{const r=i.filter(a=>a.amount_owned>=C);return k.filter(a=>r.findIndex(n=>n.card_id===a.card_id)>-1).map(a=>{var n;return{...a,amount_owned:(n=r.find(t=>t.card_id===a.card_id))==null?void 0:n.amount_owned}}).filter(a=>R[a.rarity]!==null&&M.includes(a.expansion))},[i,C]),$=o.useMemo(()=>p.filter(_),[p,d]),f=o.useMemo(()=>{const r=i.filter(a=>a.amount_owned>=w);return k.filter(a=>r.findIndex(n=>n.card_id===a.card_id)>-1).map(a=>{var n;return{...a,amount_owned:(n=r.find(t=>t.card_id===a.card_id))==null?void 0:n.amount_owned}}).filter(a=>O[a.rarity]!==null)},[i,w]),Y=o.useMemo(()=>f.filter(_),[f,d]),S=()=>{let r="";c!=null&&c.username&&(r+=`Account: ${c.username} - ${c.friend_id}

`),r+=`Looking for cards:
`;const a=x.sort((s,l)=>{const I=s.expansion.localeCompare(l.expansion);return I!==0?I:s.rarity.localeCompare(l.rarity)});for(let s=0;s<a.length;s++)(s>0?a[s-1].expansion:"")!==a[s].expansion&&(r+=`
${a[s].set_details}:
`),r+=`${a[s].rarity} ${a[s].card_id} - ${a[s].name}
`;const n=x.map(s=>s.rarity);r+=`

For trade cards:
`;const t=$.filter(s=>n.includes(s.rarity)).sort((s,l)=>s.rarity.localeCompare(l.rarity));for(let s=0;s<t.length;s++)(s>0?t[s-1].expansion:"")!==t[s].expansion&&(r+=`
${t[s].set_details}:
`),r+=`${t[s].rarity} ${t[s].card_id} - ${t[s].name}
`;return r},q=async r=>{r.preventDefault();const a=S();L({title:"Copied cards for trading to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(a)},G=async()=>{const r=Array.from(new Set(x.map(l=>l.rarity))).join(", "),a=encodeURIComponent(`Trading cards ${r}`),n=encodeURIComponent(S()),s=`https://community.tcgpocketcollectiontracker.com/new-topic?title=${a}&body=${n}&category=Trading`;window.open(s,"_blank")};return A?e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsxs(Q,{defaultValue:u,onValueChange:r=>K(r),children:[e.jsxs("div",{className:"mx-auto max-w-[900px] flex flex-row flex-wrap align-center gap-4 p-8",children:[e.jsxs(W,{className:"flex-grow m-auto flex-wrap h-auto border-2 border-slate-600 rounded-md",children:[e.jsx(T,{value:"looking_for",children:"Looking For"}),e.jsx(T,{value:"for_trade",children:"For Trade"}),e.jsx(T,{value:"buying_tokens",children:"Buying Tokens"})]}),e.jsx(X,{rarityFilter:d,setRarityFilter:U}),u==="looking_for"&&e.jsx(F,{numberFilter:j,setNumberFilter:B,options:[0,1,2,3,4,5],labelKey:"maxNum"}),u==="for_trade"&&e.jsx(F,{numberFilter:C,setNumberFilter:V,options:[2,3,4,5],labelKey:"minNum"}),u==="buying_tokens"&&e.jsx(F,{numberFilter:w,setNumberFilter:D,options:[2,3,4,5],labelKey:"minNum"}),e.jsx(E,{variant:"outline",onClick:r=>q(r),children:"Copy to clipboard"}),e.jsx(E,{variant:"outline",onClick:()=>G(),children:"Post to community"})]}),e.jsxs("div",{className:"max-w-auto mx-4 md:mx-8",children:[e.jsx(N,{value:"looking_for",children:m&&m.length>0?e.jsx(v,{cards:x}):e.jsx(Z,{})}),e.jsx(N,{value:"for_trade",children:p&&p.length>0?e.jsx(v,{cards:$}):e.jsx(re,{})}),e.jsx(N,{value:"buying_tokens",children:f&&f.length>0?e.jsx(v,{cards:Y}):e.jsx(ee,{})})]})]})}):e.jsx(ae,{})}export{de as default};
